<nav class="navbar navbar-dark bg-dark fixed-top w-100">
  <div class="container-fluid d-flex flex-column">
    <!-- Row 1: brand + nav links -->
    <div id="nav-top-row" class="d-flex justify-content-between align-items-center w-100">
      <a class="navbar-brand text-warning fw-bold" href="{{ url_for('main.index') }}">
        Buxxel
      </a>
      <ul class="navbar-nav d-flex flex-row">
        <li class="nav-item mx-3 text-center">
          <a class="nav-link text-light d-flex flex-column align-items-center" href="{{ url_for('main.index') }}">
            <i class="bi bi-house-fill fs-4"></i>
            <small class="text-light">Home</small>
          </a>
        </li>
        <li class="nav-item mx-3 text-center">
          <a class="nav-link text-light d-flex flex-column align-items-center" href="{{ url_for('main.browse') }}">
            <i class="bi bi-grid-fill fs-4"></i>
            <small class="text-light">Browse</small>
          </a>
        </li>
        <li class="nav-item mx-3 text-center">
          <a class="nav-link text-warning d-flex flex-column align-items-center" href="{{ url_for('listings_api.create_listing') }}">
            <i class="bi bi-plus-circle-fill fs-4"></i>
            <small class="text-warning">Post</small>
          </a>
        </li>
        <li class="nav-item mx-3 text-center">
          <a class="nav-link text-warning d-flex flex-column align-items-center" href="{{ url_for('listings_api.create_listing') }}">
            <i class="bi bi-plus-circle-fill fs-4"></i>
            <small class="text-warning">Register</small>
          </a>
        </li>
        <li class="nav-item mx-3 text-center">
          <a class="nav-link text-warning d-flex flex-column align-items-center" href="{{ url_for('listings_api.create_listing') }}">
            <i class="bi bi-plus-circle-fill fs-4"></i>
            <small class="text-warning">Login</small>
          </a>
        </li>
      </ul>
    </div>
{% set modal_id = "loginModal" %}
{% set label = "login" %}

<!-- Trigger button -->
{% include "components/modal_button.html" %}

{% set id = "loginModal" %}
{% set title = "login modal" %}
{% set body = "<input type='email' name='email' class='form-control mb-2' placeholder='Email'>
          <input type='password' name='password' class='form-control' placeholder='Password'>" %}
{% set footer="<button type='submit' class='btn btn-warning'>Login</button>" %}


<!-- Modal itself -->
{% include "components/modal.html"%}

    <!-- Row 2: search bar -->
    <div class="w-100 mt-2">
      <form class="d-flex" action="{{ url_for('main.browse') }}" method="get">
        <input class="form-control me-2" type="search" name="q" placeholder="Search listings..." aria-label="Search">
        <button class="btn btn-warning" type="submit">
          <i class="bi bi-search"></i>
        </button>
      </form>
    </div>
  </div>
</nav>
<!-- ALERT: could cause precedence issues later
     but this is the only way it seems to work -->
<style>
  body {
    padding-top: 120px; / adjust for navbar height /
  }
</style>

<!-- Inline jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(function() {
    let lastScrollTop = 0;
    const $navTopRow = $("#nav-top-row");
    const threshold = 100; // pixels before triggering hide

    $(window).on("scroll", function() {
      let scrollTop = $(this).scrollTop();

      if (scrollTop > lastScrollTop && scrollTop > threshold) {
        // scrolling down past threshold → animate hide
        if ($navTopRow.is(":visible")) {
          $navTopRow.slideUp(300, function() {
            $navTopRow.addClass("d-none");
          });
        }
      } else if (scrollTop < lastScrollTop) {
        // scrolling up → animate show
        if ($navTopRow.hasClass("d-none")) {
          $navTopRow.removeClass("d-none").hide().slideDown(300);
        }
      }

      lastScrollTop = scrollTop <= 0 ? 0 : scrollTop; // avoid negative values
    });
  });
</script>
